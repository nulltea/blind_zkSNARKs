#include <stdint.h>
#include "data.h"

#define N 64
#define LOGQ 24
#define QOFF 3
#define K 5
#define L 2

__attribute__((aligned(64)))
const pdata primes[5] = {
  {
    .p = 13697,
    .pinv = 2689,
    .v = 9799,
    .mont = -2949,
    .montsq = -994,
    .s = 4,
    .f = 37,
    .t = 1881,
    .twist64 = {
       -2949,  4411,  4893, -6636,  2945, -5111, -4120,  4941,
        1764, -6331,  1532, -5840,  5275,  5426,  4457,  -754,
        5020,  1892,  2372,  4190, -6388,  5254,  1751,  5091,
         620, -1076,  3458,  2482, -3954,  6597,  3927,  2375,
        4715,  3305,  3101, -5205,  6824,  2561, -3826,  1603,
        6585,  1827,  4694,  -370,  3735, -3831,   728,  4127,
       -3716, -6541,  5873,   500,  5318,  -746,  6420,   346,
        5762, -5228,  2799, -3267,  3549,  4710,  2430,   643,
    },
    .twist32n = {
        2949, -4893, -2945,  4120, -1764, -1532, -5275, -4457,
       -5020, -2372,  6388, -1751,  -620, -3458,  3954, -3927,
       -4715, -3101, -6824,  3826, -6585, -4694, -3735,  -728,
        3716, -5873, -5318, -6420, -5762, -2799, -3549, -2430,
    },
    .twist16 = {
       -2949,  2945,  1764,  5275,  5020, -6388,   620, -3954,
        4715,  6824,  6585,  3735, -3716,  5318,  5762,  3549,
    },
    .twist8n = {
        2949, -1764, -5020,  -620, -4715, -6585,  3716, -5762,
    },
    .twist4 = {
       -2949,  5020,  4715, -3716,
    },
    .twist2n = {
        2949, -4715,
    },
    .twist1 = {
       -2949,
    },
    .twist64_pinv = {
          -5,  -837,-15459,-18412,-10751, 19081, -3096,-17459,
       24804, 15301, -9220, 24880, 28699,-24014, -8215,  4110,
       -1636,-24220, 21316, -5282, -6900,-27770,-10153, -7325,
       28780, -9780, -7550,-10574,-15474,-20923,  8407, 29383,
       30187,-25751, 15517, 28459,  -344,  5249,  1038,-14909,
       12345, -2397,-26282,-11890, 16407,-12407, -8488, 21919,
      -30852,-25101, -1679,-31756, 13254, 25622, 27412, 12890,
       27522, 32148,-10129, -3139,-24995, 16742,-19330, 25091,
    },
    .twist32n_pinv = {
           5, 15459, 10751,  3096,-24804,  9220,-28699,  8215,
        1636,-21316,  6900, 10153,-28780,  7550, 15474, -8407,
      -30187,-15517,   344, -1038,-12345, 26282,-16407,  8488,
       30852,  1679,-13254,-27412,-27522, 10129, 24995, 19330,
    },
    .twist16_pinv = {
          -5,-10751, 24804, 28699, -1636, -6900, 28780,-15474,
       30187,  -344, 12345, 16407,-30852, 13254, 27522,-24995,
    },
    .twist8n_pinv = {
           5,-24804,  1636,-28780,-30187,-12345, 30852,-27522,
    },
    .twist4_pinv = {
          -5, -1636, 30187,-30852,
    },
    .twist2n_pinv = {
           5,-30187,
    },
    .twist1_pinv = {
          -5,
    },
  },
  {
    .p = 13441,
    .pinv = 2945,
    .v = 9986,
    .mont = -1669,
    .montsq = 3274,
    .s = 4,
    .f = -1815,
    .t = -208,
    .twist64 = {
       -1669,  4584, -6518, -4607,  3988, -4873,  1610,  2367,
        4991, -2071,   687, -5076,  6162,  5770,  2973,  4446,
        5184,  5718, -2747, -6468,   893,  4143, -1264, -4630,
        1458,  -912, -6233,  -139, -1849, -1775,  6365,  1218,
        -430,  6464, -1333,  1221,  -100,  2441,  -310,  6223,
        -961,  1818, -1635, -5117,  1652, -6454,  2433, -1190,
        3510, -3689, -2560,   661,  5505,   705, -3096, -4535,
       -1533,  6103,  -720,  1446, -2232, -3582, -4231,  5025,
    },
    .twist32n = {
        1669,  6518, -3988, -1610, -4991,  -687, -6162, -2973,
       -5184,  2747,  -893,  1264, -1458,  6233,  1849, -6365,
         430,  1333,   100,   310,   961,  1635, -1652, -2433,
       -3510,  2560, -5505,  3096,  1533,   720,  2232,  4231,
    },
    .twist16 = {
       -1669,  3988,  4991,  6162,  5184,   893,  1458, -1849,
        -430,  -100,  -961,  1652,  3510,  5505, -1533, -2232,
    },
    .twist8n = {
        1669, -4991, -5184, -1458,   430,   961, -3510,  1533,
    },
    .twist4 = {
       -1669,  5184,  -430,  3510,
    },
    .twist2n = {
        1669,   430,
    },
    .twist1 = {
       -1669,
    },
    .twist64_pinv = {
          -5,  -536,  6538, -1663, 13716,  1399, 22858, 23999,
       18431, -4247, -8401, -6612, -6382, 18826,-26339,-13730,
       -3008, -3242,-28987, 22716,  8445, 11439, 13072, -3862,
      -31566,  1136, -6105,-16139, -5817, 15505,  1629,-17470,
      -21166, 31040,  6475, -8635,-32356,-20215,  4554,-23345,
      -12097,-19942,-30947,  3715, 15476, -1590, 21761,-31142,
      -17738, 14871, -2560,-19435, 24833,-20927, -8216, 13769,
        7299, 16471,-23248, -1370,-19640,  2306, -8455,-12511,
    },
    .twist32n_pinv = {
           5, -6538,-13716,-22858,-18431,  8401,  6382, 26339,
        3008, 28987, -8445,-13072, 31566,  6105,  5817, -1629,
       21166, -6475, 32356, -4554, 12097, 30947,-15476,-21761,
       17738,  2560,-24833,  8216, -7299, 23248, 19640,  8455,
    },
    .twist16_pinv = {
          -5, 13716, 18431, -6382, -3008,  8445,-31566, -5817,
      -21166,-32356,-12097, 15476,-17738, 24833,  7299,-19640,
    },
    .twist8n_pinv = {
           5,-18431,  3008, 31566, 21166, 12097, 17738, -7299,
    },
    .twist4_pinv = {
          -5, -3008,-21166,-17738,
    },
    .twist2n_pinv = {
           5, 21166,
    },
    .twist1_pinv = {
          -5,
    },
  },
  {
    .p = 13313,
    .pinv = -13311,
    .v = 10082,
    .mont = -1029,
    .montsq = -6199,
    .s = 4,
    .f = 461,
    .t = 5011,
    .twist64 = {
       -1029,  -315, -5802,  6103, -4109,   644,  2099, -1531,
       -3729, -2500, -1037, -2491,  1411, -2285,  4191, -4966,
       -6139, -5683, -1468,    94, -1058,  5110,  5368, -4334,
        6009, -3051, -4466, -3269,  2803,  3575,   551,  3429,
         778, -1392, -5860,  3640,  4918,  6396, -4291,  4392,
       -3546, -5976, -1286, -3654,  4587, -3758,  2925, -3180,
         385, -1784, -5980, -2374,  6609,   393,   392,   120,
        6014, -1691,  6003, -4683,  4272,  3753, -4285,  6024,
    },
    .twist32n = {
        1029,  5802,  4109, -2099,  3729,  1037, -1411, -4191,
        6139,  1468,  1058, -5368, -6009,  4466, -2803,  -551,
        -778,  5860, -4918,  4291,  3546,  1286, -4587, -2925,
        -385,  5980, -6609,  -392, -6014, -6003, -4272,  4285,
    },
    .twist16 = {
       -1029, -4109, -3729,  1411, -6139, -1058,  6009,  2803,
         778,  4918, -3546,  4587,   385,  6609,  6014,  4272,
    },
    .twist8n = {
        1029,  3729,  6139, -6009,  -778,  3546,  -385, -6014,
    },
    .twist4 = {
       -1029, -6139,   778,   385,
    },
    .twist2n = {
        1029,  -778,
    },
    .twist1 = {
       -1029,
    },
    .twist64_pinv = {
          -5, -1339, 29014, 27607,-27661, 12932,-21453, -2555,
       25967,-14788,-24589, -3515, 27011,  6931,-15265,-23398,
       -7163, 17869, 10820, -6050, -7202,  7158,-19208, 18194,
      -31879,-20459,  5774, -2245,-20749, -7689,  5671,-30363,
       -1270,-17776, 14620,-20936,  6966, -5892,-29891, -3800,
       14886,-14168, 13050, 10682, 21995, 18770, -6291, -7276,
      -12927, 22792,-26460, 11962,-23087, 11657, 24968,-24456,
       32638, 30053,-17549, 10677, 20656,-17751, 21315, 30600,
    },
    .twist32n_pinv = {
           5,-29014, 27661, 21453,-25967, 24589,-27011, 15265,
        7163,-10820,  7202, 19208, 31879, -5774, 20749, -5671,
        1270,-14620, -6966, 29891,-14886,-13050,-21995,  6291,
       12927, 26460, 23087,-24968,-32638, 17549,-20656,-21315,
    },
    .twist16_pinv = {
          -5,-27661, 25967, 27011, -7163, -7202,-31879,-20749,
       -1270,  6966, 14886, 21995,-12927,-23087, 32638, 20656,
    },
    .twist8n_pinv = {
           5,-25967,  7163, 31879,  1270,-14886, 12927,-32638,
    },
    .twist4_pinv = {
          -5, -7163, -1270,-12927,
    },
    .twist2n_pinv = {
           5,  1270,
    },
    .twist1_pinv = {
          -5,
    },
  },
  {
    .p = 12289,
    .pinv = -12287,
    .v = 10922,
    .mont = 4091,
    .montsq = -1337,
    .s = 4,
    .f = 5879,
    .t = -3910,
    .twist64 = {
        4091,  -432,  1875,  4407,   586, -1690, -1711, -3412,
       -6014,  4426,  2125,    79, -5890,  2181,  4615,  5145,
       -1081, -1538, -1688, -1549, -2579,    14,  1134,  5831,
        5329,  1534,  1364,  -117,  2812, -5719,  3743, -4042,
        4401,   100, -4189,  4783, -5825, -4843,   965,  4431,
        2530, -3983, -3109, -6049,  1591,  5981,  5190,  2564,
       -1229, -1237, -1885, -5217, -4751, -3872,  5882, -2829,
        4342, -4679,  1960,  -997,  5266, -3569,  5847, -5664,
    },
    .twist32n = {
       -4091, -1875,  -586,  1711,  6014, -2125,  5890, -4615,
        1081,  1688,  2579, -1134, -5329, -1364, -2812, -3743,
       -4401,  4189,  5825,  -965, -2530,  3109, -1591, -5190,
        1229,  1885,  4751, -5882, -4342, -1960, -5266, -5847,
    },
    .twist16 = {
        4091,   586, -6014, -5890, -1081, -2579,  5329,  2812,
        4401, -5825,  2530,  1591, -1229, -4751,  4342,  5266,
    },
    .twist8n = {
       -4091,  6014,  1081, -5329, -4401, -2530,  1229, -4342,
    },
    .twist4 = {
        4091, -1081,  4401, -1229,
    },
    .twist2n = {
       -4091, -4401,
    },
    .twist1 = {
        4091,
    },
    .twist64_pinv = {
          -5,  -432, 30547,-16073,  8778, -9882,-13999,-19796,
      -30590, 12618,-26547, 12367, 18686,  6277,-15865, 25625,
      -21561, 23038, 31080, 27123,-31251, 24590, 25710,-14649,
       -6959, 26110, 17748, -4213,-13572, 14761, 16031,-12234,
       -7887, 16484, 24483, 17071,  6463,  -747,  5061, 16719,
      -22046,-16271, -7205,  6239,-18889,-22691, -3002, 18948,
       27443, -5333, 26787,  7071,-17039, -3872, 14074, 25843,
       -3850, 15801,-30808, -5093,-19310,  8719,-14633, -5664,
    },
    .twist32n_pinv = {
           5,-30547, -8778, 13999, 30590, 26547,-18686, 15865,
       21561,-31080, 31251,-25710,  6959,-17748, 13572,-16031,
        7887,-24483, -6463, -5061, 22046,  7205, 18889,  3002,
      -27443,-26787, 17039,-14074,  3850, 30808, 19310, 14633,
    },
    .twist16_pinv = {
          -5,  8778,-30590, 18686,-21561,-31251, -6959,-13572,
       -7887,  6463,-22046,-18889, 27443,-17039, -3850,-19310,
    },
    .twist8n_pinv = {
           5, 30590, 21561,  6959,  7887, 22046,-27443,  3850,
    },
    .twist4_pinv = {
          -5,-21561, -7887, 27443,
    },
    .twist2n_pinv = {
           5,  7887,
    },
    .twist1_pinv = {
          -5,
    },
  },
  {
    .p = 12161,
    .pinv = 4225,
    .v = 11037,
    .mont = 4731,
    .montsq = -6040,
    .s = 4,
    .f = -5303,
    .t = -2380,
    .twist64 = {
        4731, -2389,  2998, -1609,  -974,  5147,   357,  4169,
        4776,  5801, -2225, -3637, -5240, -5122,  4193, -3017,
       -1849,  3990, -3480,  -988,  2599, -1261,  1557,  3671,
        -733,   365,  5625,  2226,  3819,  1881,  1834,  5441,
        5221,  1664, -1177,  4684,  1218,  2778, -5166, -3815,
       -1153, -3109,  5729, -3168, -5009,   437, -5593,  3598,
       -1858,  2352,  2429,  4282,  1020,  3225,  3222,  2676,
         592, -1705,  5876,  -736,  -181,  3541,   -71,  -761,
    },
    .twist32n = {
       -4731, -2998,   974,  -357, -4776,  2225,  5240, -4193,
        1849,  3480, -2599, -1557,   733, -5625, -3819, -1834,
       -5221,  1177, -1218,  5166,  1153, -5729,  5009,  5593,
        1858, -2429, -1020, -3222,  -592, -5876,   181,    71,
    },
    .twist16 = {
        4731,  -974,  4776, -5240, -1849,  2599,  -733,  3819,
        5221,  1218, -1153, -5009, -1858,  1020,   592,  -181,
    },
    .twist8n = {
       -4731, -4776,  1849,   733, -5221,  1153,  1858,  -592,
    },
    .twist4 = {
        4731, -1849,  5221, -1858,
    },
    .twist2n = {
       -4731, -5221,
    },
    .twist1 = {
        4731,
    },
    .twist64_pinv = {
          -5,  -981, 18102, 17719, 13618,-11877,   997,-15159,
       -6488, -1239,-28977,-30901, 12168,-13570, 20705, 32695,
      -13241, 14998,-22936, 20004,-29273,-19309, 24725,-22057,
      -16733,-30739,-23943,-32334, 13419, 17369, 15402,-14911,
      -26907, 18048,  7911, -1972,-31294,  6106, -2862,  3481,
      -21761,-28325, 22241,-15456,  5103, 11317, 28071, -2802,
       14270,-24272,-26627,  3514,-15876, -5863,-18538,-31628,
       10832,  5335,-12044,-29408, 21707, 18517, 27705, -3961,
    },
    .twist32n_pinv = {
           5,-18102,-13618,  -997,  6488, 28977,-12168,-20705,
       13241, 22936, 29273,-24725, 16733, 23943,-13419,-15402,
       26907, -7911, 31294,  2862, 21761,-22241, -5103,-28071,
      -14270, 26627, 15876, 18538,-10832, 12044,-21707,-27705,
    },
    .twist16_pinv = {
          -5, 13618, -6488, 12168,-13241,-29273,-16733, 13419,
      -26907,-31294,-21761,  5103, 14270,-15876, 10832, 21707,
    },
    .twist8n_pinv = {
           5,  6488, 13241, 16733, 26907, 21761,-14270,-10832,
    },
    .twist4_pinv = {
          -5,-13241,-26907, 14270,
    },
    .twist2n_pinv = {
           5, 26907,
    },
    .twist1_pinv = {
          -5,
    },
  },
};

__attribute__((aligned(64)))
const qdata modulus = {
  .q = {{
     16381,  1023,
  }},
  .pmq = {{
      8085,   123,
  }},
  .xvec = {
    {{
        4963,   590,
    }},
    {{
        2399,   595,
    }},
    {{
       12085,   296,
    }},
    {{
       16051,   125,
    }},
    {{
       14975,   153,
    }},
  },
};
